<?xml version="1.0"?>
<odoo>
    <template id="cfdiv40_nomina">
<cfdi:Comprobante
    xsi:schemaLocation="http://www.sat.gob.mx/cfd/4 http://www.sat.gob.mx/sitio_internet/cfd/4/cfdv40.xsd http://www.sat.gob.mx/nomina12 http://www.sat.gob.mx/sitio_internet/cfd/nomina/nomina12.xsd"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:cfdi="http://www.sat.gob.mx/cfd/4"
    xmlns:nomina12="http://www.sat.gob.mx/nomina12"
    Version="4.0"
    t-att-Fecha="fecha"
    t-att-Folio="format_string(folio, 25)"
    t-att-Serie="format_string(serie, 40)"
    Sello="TO BE INJECTED"
    t-att-SubTotal="format_float(subtotal)"
    t-att-Descuento="format_float(descuento)"
    Moneda="MXN"
    t-att-Total="format_float(total)"
    TipoDeComprobante="N"
    Exportacion="01"
    MetodoPago="PUE"
    t-att-LugarExpedicion="lugar_expedicion"
    t-att-NoCertificado="no_certificado"
    t-att-Certificado="certificado">
    <t t-if="cfdi_relationado_data">
        <t t-foreach="cfdi_relationado_data" t-as="code">
            <cfdi:CfdiRelacionados t-if="cfdi_relationado_data[code]" t-att-TipoRelacion="code">
                <t t-foreach="cfdi_relationado_data[code]" t-as="uuid">
                    <cfdi:CfdiRelacionado t-att-UUID="uuid" />
                </t>
            </cfdi:CfdiRelacionados>
        </t>
    </t>
    <cfdi:Emisor
        t-att-Rfc="emisor['rfc']"
        t-att-Nombre="format_string(emisor['nombre'], 254)"
        t-att-RegimenFiscal="emisor['regimen_fiscal']"/>
    <cfdi:Receptor
        t-att-Rfc="receptor['rfc']"
        t-att-Nombre="format_string(receptor['nombre'], 254)"
        t-att-DomicilioFiscalReceptor="receptor['domicilio_fiscal_receptor']"
        RegimenFiscalReceptor="605"
        UsoCFDI="CN01"/>
    <cfdi:Conceptos>
        <cfdi:Concepto
            ClaveProdServ="84111505"
            Cantidad="1"
            ClaveUnidad="ACT"
            Descripcion="Pago de nómina"
            ObjetoImp="01"
            t-att-ValorUnitario="format_float(concepto['valor_unitario'], precision=2)"
            t-att-Importe="format_float(concepto['importe'], precision=2)"
            t-att-Descuento="format_float(concepto['descuento'], precision=2)">
        </cfdi:Concepto>
    </cfdi:Conceptos>
    <cfdi:Complemento>
        <nomina12:Nomina
            Version="1.2"
            t-att-TipoNomina="nomina['tipo_nomina']"
            t-att-FechaPago="nomina['fecha_pago']"
            t-att-FechaInicialPago="nomina['fecha_inicial_pago']"
            t-att-FechaFinalPago="nomina['fecha_final_pago']"
            t-att-NumDiasPagados="format_float(nomina['num_dias_pagados'], precision=3)"
            t-att-TotalPercepciones="format_float(nomina['total_percepciones'], precision=2)"
            t-att-TotalDeducciones="format_float(nomina['total_deducciones'], precision=2)"
            t-att-TotalOtrosPagos="format_float(nomina['total_otros_pagos'], precision=2)">
            <nomina12:Emisor
                t-att-Curp="nomina_emisor['curp']"
                t-att-RegistroPatronal="nomina_emisor['registro_patronal']"
                t-att-RfcPatronOrigen="nomina_emisor['rfc_patron_origen']"/>
            <nomina12:Receptor
                t-att-Curp="nomina_receptor['curp']"
                t-att-NumSeguridadSocial="nomina_receptor['num_seguridad_social']"
                t-att-FechaInicioRelLaboral="nomina_receptor['fecha_inicio_rel_laboral']"
                t-att-Antigüedad="nomina_receptor['antigüedad']"
                t-att-TipoContrato="nomina_receptor['tipo_contrato']"
                t-att-TipoRegimen="nomina_receptor['tipo_regimen']"
                t-att-TipoJornada="nomina_receptor['tipo_jornada']"
                t-att-NumEmpleado="format_string(nomina_receptor['num_empleado'], 20)"
                t-att-RiesgoPuesto="nomina_receptor['riesgo_puesto']"
                t-att-PeriodicidadPago="nomina_receptor['periodicidad_pago']"
                t-att-CuentaBancaria="nomina_receptor['cuenta_bancaria']"
                t-att-Banco="nomina_receptor['banco']"
                t-att-Puesto="nomina_receptor['puesto']"
                t-att-Departamento="nomina_receptor['departamento']"
                t-att-SalarioBaseCotApor="format_float(nomina_receptor['salario_base_cot_apor'], precision=2)"
                t-att-SalarioDiarioIntegrado="format_float(nomina_receptor['salario_diario_integrado'], precision=2)"
                t-att-ClaveEntFed="nomina_receptor['clave_ent_fed']"/>
            <nomina12:Percepciones t-if="percepcion_list"
                t-att-TotalSueldos="format_float(nomina_percepciones['total_sueldos'], precision=2)"
                t-att-TotalGravado="format_float(nomina_percepciones['total_gravado'], precision=2)"
                t-att-TotalExento="format_float(nomina_percepciones['total_exento'], precision=2)">
                <t t-foreach="percepcion_list" t-as="percepcion">
                    <nomina12:Percepcion
                        t-att-TipoPercepcion="percepcion['tipo_percepcion']"
                        t-att-Clave="percepcion['clave']"
                        t-att-Concepto="percepcion['concepto']"
                        t-att-ImporteGravado="format_float(percepcion['importe_gravado'], precision=2)"
                        t-att-ImporteExento="format_float(percepcion['importe_exento'], precision=2)"/>
                </t>
            </nomina12:Percepciones>
            <nomina12:Deducciones t-if="deduccion_list"
                t-att-TotalOtrasDeducciones="format_float(nomina_deducciones['total_otras_deducciones'], precision=2)"
                t-att-TotalImpuestosRetenidos="format_float(nomina_deducciones['total_impuestos_retenidos'], precision=2)">
                <t t-foreach="deduccion_list" t-as="deduccion">
                    <nomina12:Deduccion
                        t-att-TipoDeduccion="deduccion['tipo_deduccion']"
                        t-att-Clave="deduccion['clave']"
                        t-att-Concepto="deduccion['concepto']"
                        t-att-Importe="format_float(deduccion['importe'], precision=2)"/>
                </t>
            </nomina12:Deducciones>
            <nomina12:OtrosPagos t-if="otro_pago_list">
                <t t-foreach="otro_pago_list" t-as="otro_pago">
                    <nomina12:OtroPago
                        t-att-TipoOtroPago="otro_pago['tipo_otro_pago']"
                        t-att-Clave="otro_pago['clave']"
                        t-att-Concepto="otro_pago['concepto']"
                        t-att-Importe="format_float(otro_pago['importe'], precision=2)">
                        <nomina12:SubsidioAlEmpleo
                            t-if="otro_pago['tipo_otro_pago'] in ['002', '007', '008']"
                            t-att-SubsidioCausado="format_float(otro_pago['subsidio_causado'], precision=2)"/>
                        <nomina12:CompensacionSaldosAFavor t-if="otro_pago['saldo_a_favor']"
                            t-att-SaldoAFavor="format_float(otro_pago['saldo_a_favor'], precision=2)"
                            t-att-Año="otro_pago['año']"
                            t-att-RemanenteSalFav="format_float(otro_pago['remanente_sal_fav'], precision=2)"/>
                    </nomina12:OtroPago>
                </t>
            </nomina12:OtrosPagos>
            <nomina12:Incapacidades t-if="incapacidad_list">
                <t t-foreach="incapacidad_list" t-as="incapacidad">
                    <nomina12:Incapacidad
                        t-att-DiasIncapacidad="incapacidad['dias_incapacidad']"
                        t-att-TipoIncapacidad="incapacidad['tipo_incapacidad']"/>
                </t>
            </nomina12:Incapacidades>
        </nomina12:Nomina>
    </cfdi:Complemento>
</cfdi:Comprobante>
    </template>
</odoo>
